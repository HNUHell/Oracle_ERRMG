# ORA-01500 to ORA-02098

## ORA-01747: user.table.column, table.column 或列说明无效【已验证】

> ORA-01747: invalid user.table.column, table.column, or column specification

### 原因1: 列名为关键字。

* 分析: 一般为在SQL语句或存储过程、函数等中使用到的此字段为oracle的保留关键字，且保留方式标识了此关键字在某些情况下，例如在DML中是否不允许作为标识符的。如下列情况:

	```sql
	-- 查询能做属性但不能作为标识符或某些场景（如DML操作）下不能作为标识符的关键字
	select t.*
	  from v$reserved_words t
	 where (t.res_semi = 'Y' or t.reserved = 'Y')
	   and t.res_attr = 'N';
	-- 根据上面关键字建表，为测试需要，实际使用时请避免将Oracle保留关键字作为表的字段！
	create table ora_01747_1 (
	   "TRIGGER" number, "WHERE" number, "REVOKE" number, "INCREMENT" number, "THEN" number, 
	   "FILE" number, "PRIOR" number, "CONNECT" number, "COMMENT" number, "SYSDATE" number, 
	   "ONLINE" number, "DECIMAL" number, "SESSION" number, "MODIFY" number, "IN" number, 
	   "@" number, "," number, "GRANT" number, "INTO" number, "VALIDATE" number, "." number, 
	   "ADD" number, "ORDER" number, "HAVING" number, "TO" number, "NULL" number, "RENAME" number, 
	   "LEVEL" number, "USER" number, "ANY" number, /*"ROWID" number, --不可作建表属性*/ 
	   "SHARE" number, "MODE" number, "UNION" number, "/" number, "SET" number, "INDEX" number, 
	   "MAXEXTENTS" number, "VALUES" number, "|" number, "VIEW" number, "[" number, "WITH" number, 
	   "EXCLUSIVE" number, "ALTER" number, "FROM" number, "SELECT" number, "BY" number, "-" number, 
	   "MLSLABEL" number, "AND" number, "+" number, "ROWS" number, "CHECK" number, ":" number, 
	   "VARCHAR2" number, "IMMEDIATE" number, "CURRENT" number, "AS" number, "*" number, "TABLE" number, 
	   "LONG" number, "SYNONYM" number, "ASC" number, "UNIQUE" number, "LIKE" number, "DESC" number, 
	   "VARCHAR" number, "INITIAL" number, "CHAR" number, "=" number, "DROP" number, "AUDIT" number, 
	   "ROWNUM" number, "FLOAT" number, "COMPRESS" number, "OFFLINE" number, "NOT" number, "DELETE" number, 
	   "^" number, "BETWEEN" number, "EXISTS" number, "IDENTIFIED" number, "WHENEVER" number, "INTEGER" number, 
	   "SIZE" number, "NOWAIT" number, ")" number, "]" number, "NOCOMPRESS" number, "COLUMN" number, "ELSE" number, 
	   "FOR" number, "INTERSECT" number, "!" number, "PRIVILEGES" number, "SUCCESSFUL" number, "PCTFREE" number, 
	   "UPDATE" number, "ACCESS" number, "RESOURCE" number, "UID" number, "DATE" number, "NOAUDIT" number, 
	   "RAW" number, /*"&" number,--不可作建表属性 */"OPTION" number, "ROW" number, "SMALLINT" number, 
	   "MINUS" number, "OF" number, "ON" number, ">" number, "INSERT" number, "DEFAULT" number, "ALL" number, 
	   "START" number, "IS" number, "CREATE" number, "DISTINCT" number, "LOCK" number, "CLUSTER" number, 
	   "GROUP" number, "PUBLIC" number, "OR" number, "<" number, "NUMBER" number, "(" number/* ,"" number --不可作建表属性*/
	);

	-- 异常测试（不是所有属性错误使用都会产生ORA-01747的异常，还可能产生ORA-00936、ORA-01788、ORA-01745等异常）
	-- ORA-01747: user.table.column, table.column 或列说明无效
	select SET from ora_01747_1;
	update ora_01747_1 set NUMBER = 1;
	update ora_01747_1 set ,"NUMBER" = 1;
	insert into ora_01747_1("TRIGGER", ,WHERE) values(1, ,1);
	```
	
* 措施: 在使用此字段时，添加英文双引号（""）包裹。
	- 通过下面语句可查询此类关键字的使用情况: 
	
		```sql
		select a.table_name 表,
			   a.column_name 原字段,
			   '"' || a.column_name || '"' 使用需加双引号,
			   'select "' || a.column_name || '" from ' || a.table_name ||
			   ' where rownum = 1;' 简单查询语句,
			   b.reserved "是否不能作标识符",
			   b.res_type "是否不能作类型名称",
			   b.res_attr "是否不能作属性名称",
			   b.res_semi "是否某些环境(DML)不能作标识符",
			   b.duplicate
		  from user_tab_columns a, v$reserved_words b
		 where a.column_name = b.keyword
		   and b.res_semi = 'Y'
		--  and a.table_name = '表名'
		--  and a.column_name = '字段名'
		;
		```
		
* 备注: **实际使用时请避免将Oracle保留关键字作为表的字段！**

### 原因2: DML语句缺失列或多逗号。

* 分析: 一般为使用各种方式动态拼接SQL时，拼接有误，使得insert语句或update语句中逗号分隔的左边或右边出现空，示例可参见上面原因1的分析代码。
* 措施: 检查拼接逻辑，加上缺失字段或去除多余的逗号
